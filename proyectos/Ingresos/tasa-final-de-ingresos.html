<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tasa de Ingresos 2015-2025, INEGI (ENOE)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


<link rel="stylesheet" href="../../styles/perfil.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Portafolio.html"> 
<span class="menu-text">Portafolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../MYCV.pdf" target="_blank"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tasa de Ingresos 2015-2025, INEGI (ENOE)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="description">
        <p>El presente proyecto es un ejemplo de la aplicación de diseño muestral en la encuesta de la ENOE del INEGI para calcular las tasas anuales del ingreso en México durante un periodo de 10 años  (2015 al 2025).
      </p>
<div class="description">
Las librerías que usaremos serán las siguientes:
      <p></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="description">
    <p>
        Para obtener las bases de datos necesarias, puedes descargarlas aquí:
        <a href="https://www.inegi.org.mx/programas/enoe/15ymas/#Microdatos" target="_blank">
            Encuesta Nacional de Ocupación y Empleo (ENOE), población de 15 años y más de edad
        </a>
        .
    </p>
</div>
<div class="description">
Para cargar las bases necesitamos crear las rutas y establecer unos valores para poner automatizar el trabajo.
      <p></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Asegúrate de reemplazar el código con la ruta en la que tienes los documentos.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ruta<span class="ot">&lt;-</span> <span class="st">"C:/Users/USER/Downloads/Bases de datos/INEGI/ENOE SDME 2015 a 2025/conjunto_de_datos_sdem_enoe_"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>años<span class="ot">&lt;-</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2025</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>trimestres<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="description">
Con esto podemos emplear el bucle para abrir las bases de datos.
      <p></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (año <span class="cf">in</span> años) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (trimestre <span class="cf">in</span> trimestres) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    nombre_archivo <span class="ot">&lt;-</span> <span class="fu">paste0</span>(ruta, año, <span class="st">"_"</span>, trimestre, <span class="st">"t.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    nombre_variable <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Enoe_"</span>, año, <span class="st">"_T"</span>, trimestre)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Intenta leer el archivo y asignarlo</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assign</span>(nombre_variable, <span class="fu">read.csv</span>(nombre_archivo))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"✅ Éxito al cargar:"</span>, nombre_variable, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Si ocurre un error (como que el archivo no existe), ejecuta esto</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"⚠️ AVISO: No se pudo cargar el archivo:"</span>, nombre_archivo, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Puedes añadir una condición específica si es el 2020 T2 para un mensaje claro</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> trimestre <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"   * Razón: Archivo omitido intencionalmente (encuesta no realizada en T2 2020)."</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"   * Mensaje de error:"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) <span class="co"># Salto de línea para separar las iteraciones</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># El bucle sigue automáticamente con la siguiente iteración sin detenerse</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ Éxito al cargar: Enoe_2015_T1 
✅ Éxito al cargar: Enoe_2015_T2 
✅ Éxito al cargar: Enoe_2015_T3 
✅ Éxito al cargar: Enoe_2015_T4 
✅ Éxito al cargar: Enoe_2016_T1 
✅ Éxito al cargar: Enoe_2016_T2 
✅ Éxito al cargar: Enoe_2016_T3 
✅ Éxito al cargar: Enoe_2016_T4 
✅ Éxito al cargar: Enoe_2017_T1 
✅ Éxito al cargar: Enoe_2017_T2 
✅ Éxito al cargar: Enoe_2017_T3 
✅ Éxito al cargar: Enoe_2017_T4 
✅ Éxito al cargar: Enoe_2018_T1 
✅ Éxito al cargar: Enoe_2018_T2 
✅ Éxito al cargar: Enoe_2018_T3 
✅ Éxito al cargar: Enoe_2018_T4 
✅ Éxito al cargar: Enoe_2019_T1 
✅ Éxito al cargar: Enoe_2019_T2 
✅ Éxito al cargar: Enoe_2019_T3 
✅ Éxito al cargar: Enoe_2019_T4 
✅ Éxito al cargar: Enoe_2020_T1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file(file, "rt"): no fue posible abrir el archivo
'C:/Users/USER/Downloads/Bases de datos/INEGI/ENOE SDME 2015 a
2025/conjunto_de_datos_sdem_enoe_2020_2t.csv': No such file or directory</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>⚠️ AVISO: No se pudo cargar el archivo: C:/Users/USER/Downloads/Bases de datos/INEGI/ENOE SDME 2015 a 2025/conjunto_de_datos_sdem_enoe_2020_2t.csv 
   * Razón: Archivo omitido intencionalmente (encuesta no realizada en T2 2020). 

✅ Éxito al cargar: Enoe_2020_T3 
✅ Éxito al cargar: Enoe_2020_T4 
✅ Éxito al cargar: Enoe_2021_T1 
✅ Éxito al cargar: Enoe_2021_T2 
✅ Éxito al cargar: Enoe_2021_T3 
✅ Éxito al cargar: Enoe_2021_T4 
✅ Éxito al cargar: Enoe_2022_T1 
✅ Éxito al cargar: Enoe_2022_T2 
✅ Éxito al cargar: Enoe_2022_T3 
✅ Éxito al cargar: Enoe_2022_T4 
✅ Éxito al cargar: Enoe_2023_T1 
✅ Éxito al cargar: Enoe_2023_T2 
✅ Éxito al cargar: Enoe_2023_T3 
✅ Éxito al cargar: Enoe_2023_T4 
✅ Éxito al cargar: Enoe_2024_T1 
✅ Éxito al cargar: Enoe_2024_T2 
✅ Éxito al cargar: Enoe_2024_T3 
✅ Éxito al cargar: Enoe_2024_T4 
✅ Éxito al cargar: Enoe_2025_T1 
✅ Éxito al cargar: Enoe_2025_T2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file(file, "rt"): no fue posible abrir el archivo
'C:/Users/USER/Downloads/Bases de datos/INEGI/ENOE SDME 2015 a
2025/conjunto_de_datos_sdem_enoe_2025_3t.csv': No such file or directory</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>⚠️ AVISO: No se pudo cargar el archivo: C:/Users/USER/Downloads/Bases de datos/INEGI/ENOE SDME 2015 a 2025/conjunto_de_datos_sdem_enoe_2025_3t.csv 
   * Mensaje de error: no se puede abrir la conexión </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file(file, "rt"): no fue posible abrir el archivo
'C:/Users/USER/Downloads/Bases de datos/INEGI/ENOE SDME 2015 a
2025/conjunto_de_datos_sdem_enoe_2025_4t.csv': No such file or directory</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>⚠️ AVISO: No se pudo cargar el archivo: C:/Users/USER/Downloads/Bases de datos/INEGI/ENOE SDME 2015 a 2025/conjunto_de_datos_sdem_enoe_2025_4t.csv 
   * Mensaje de error: no se puede abrir la conexión </code></pre>
</div>
</div>
<div class="description">
<strong>Notas importantes:</strong> el código está pensado para arrojar mensajes de "Exito al cargar" y "Aviso: no se pudo cargar". Para el trimestre 2 del año 2020, debido a la pandemia, no existen datos de la ENOE. Lo mismo pasa para los trimestres 3 y 4 del 2025 (debido a que aún no existen datos).
      <p></p>
<div class="description">
Lo siguiente es preparar los datos. Para ello, vamos a hacer tres pasos importantes: filtrar los datos por ingresos superiores a 0, aplicar diseño muestral y calcular la media y los intervalos de confianza. Para ello, creamos un bucle que almacenará los estadísticos resultantes en un sólo dataframe.
      <p></p>
<div class="description">
Notas: 
  *El diseño muestral presenta variaciones en las variables, por lo que es necesario ajustar el bucle.
  *Es necesario emplear el diseño muestral mediante svy para tener datos más precisos.
      <p></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creamos un data frame que contendrá los resultados de la iteración</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>serie_ingreso_total <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (año <span class="cf">in</span> años) {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (trimestre <span class="cf">in</span> trimestres) {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    nombre_df <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Enoe_"</span>, año, <span class="st">"_T"</span>, trimestre)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Ajuste Condicional del Factor de Peso ---</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (año <span class="sc">&gt;</span> <span class="dv">2020</span> <span class="sc">|</span> (año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> trimestre <span class="sc">&gt;=</span> <span class="dv">2</span>)) {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      peso_actual_str <span class="ot">&lt;-</span> <span class="st">"fac_tri"</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      peso_antiguo_str <span class="ot">&lt;-</span> <span class="st">"FAC_TRI"</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      peso_actual_str <span class="ot">&lt;-</span> <span class="st">"fac"</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      peso_antiguo_str <span class="ot">&lt;-</span> <span class="st">"FAC"</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ---------------------------------------------</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>      df_actual <span class="ot">&lt;-</span> <span class="fu">get</span>(nombre_df)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>      <span class="co">#  Corrección: UPM (mayúsculas) a upm (minúsculas)</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"upm"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df_actual)) <span class="sc">&amp;&amp;</span> (<span class="st">"UPM"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df_actual))) {</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        df_actual <span class="ot">&lt;-</span> df_actual <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">upm =</span> UPM) </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># NUEVA CORRECCIÓN: EST (mayúsculas) a est (minúsculas)</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"est"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df_actual)) <span class="sc">&amp;&amp;</span> (<span class="st">"EST"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df_actual))) {</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        df_actual <span class="ot">&lt;-</span> df_actual <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">est =</span> EST) </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"   * AVISO: Columna 'EST' renombrada a 'est' en"</span>, nombre_df, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Corrección: Variable de Ingreso (ingocup / INGOCUP)</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">"ingocup"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df_actual))) {</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="st">"inglab"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df_actual)) {</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>          df_actual <span class="ot">&lt;-</span> df_actual <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ingocup =</span> inglab)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"INGOCUP"</span> <span class="sc">%in%</span> <span class="fu">names</span>(df_actual)) {</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>          df_actual <span class="ot">&lt;-</span> df_actual <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ingocup =</span> INGOCUP)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>        } </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Corrección: Factor de Ponderación (FAC / FAC_TRI) a minúsculas</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span>(peso_actual_str <span class="sc">%in%</span> <span class="fu">names</span>(df_actual)) <span class="sc">&amp;&amp;</span> (peso_antiguo_str <span class="sc">%in%</span> <span class="fu">names</span>(df_actual))) {</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Usamos := y !!sym() para renombrar la variable de texto</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>        df_actual <span class="ot">&lt;-</span> df_actual <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="sc">!!</span><span class="fu">sym</span>(peso_actual_str) <span class="sc">:</span><span class="er">=</span> <span class="sc">!!</span><span class="fu">sym</span>(peso_antiguo_str))</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>      <span class="co"># =======================================================</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>      <span class="co"># A. Filtrado y Preparación</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>      df_filt <span class="ot">&lt;-</span> df_actual <span class="sc">%&gt;%</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(ingocup <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(ingocup)) </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># B. Diseño Muestral y Ponderación</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>      formula_peso <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"~"</span>, peso_actual_str))</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>      diseno_actual <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">ids =</span> <span class="sc">~</span>upm, </span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">strata =</span> <span class="sc">~</span>est, <span class="co"># Ahora 'est' existe</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> df_filt, </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">weights =</span> formula_peso,</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">nest =</span> <span class="cn">TRUE</span> <span class="do">##Para muestras con un solo estrato</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>      <span class="co"># C. Cálculo de Media e IC</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>      media_ponderada <span class="ot">&lt;-</span> <span class="fu">svymean</span>(<span class="sc">~</span>ingocup, diseno_actual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>      ic_95 <span class="ot">&lt;-</span> <span class="fu">confint</span>(media_ponderada)</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># D. Almacenar resultados</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>      tabla_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        Año <span class="ot">=</span> año,</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">Trimestre =</span> trimestre,</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">Media =</span> <span class="fu">as.numeric</span>(media_ponderada[<span class="dv">1</span>]),</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">IC_Inferior =</span> <span class="fu">as.numeric</span>(ic_95[<span class="dv">1</span>]),</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">IC_Superior =</span> <span class="fu">as.numeric</span>(ic_95[<span class="dv">2</span>])</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>      <span class="co"># E. Consolidar</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>      serie_ingreso_total <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(serie_ingreso_total, tabla_temp) <span class="co">#Apila los resultados</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✅ Éxito:"</span>, nombre_df, <span class="st">"procesado usando peso:"</span>, peso_actual_str, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"⚠️ Omitido:"</span>, nombre_df, <span class="st">"– Error:"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ Éxito: Enoe_2015_T1 procesado usando peso: fac 
✅ Éxito: Enoe_2015_T2 procesado usando peso: fac 
✅ Éxito: Enoe_2015_T3 procesado usando peso: fac 
✅ Éxito: Enoe_2015_T4 procesado usando peso: fac 
✅ Éxito: Enoe_2016_T1 procesado usando peso: fac 
✅ Éxito: Enoe_2016_T2 procesado usando peso: fac 
✅ Éxito: Enoe_2016_T3 procesado usando peso: fac 
✅ Éxito: Enoe_2016_T4 procesado usando peso: fac 
✅ Éxito: Enoe_2017_T1 procesado usando peso: fac 
✅ Éxito: Enoe_2017_T2 procesado usando peso: fac 
✅ Éxito: Enoe_2017_T3 procesado usando peso: fac 
✅ Éxito: Enoe_2017_T4 procesado usando peso: fac 
✅ Éxito: Enoe_2018_T1 procesado usando peso: fac 
✅ Éxito: Enoe_2018_T2 procesado usando peso: fac 
✅ Éxito: Enoe_2018_T3 procesado usando peso: fac 
✅ Éxito: Enoe_2018_T4 procesado usando peso: fac 
✅ Éxito: Enoe_2019_T1 procesado usando peso: fac 
✅ Éxito: Enoe_2019_T2 procesado usando peso: fac 
   * AVISO: Columna 'EST' renombrada a 'est' en Enoe_2019_T3 
✅ Éxito: Enoe_2019_T3 procesado usando peso: fac 
   * AVISO: Columna 'EST' renombrada a 'est' en Enoe_2019_T4 
✅ Éxito: Enoe_2019_T4 procesado usando peso: fac 
✅ Éxito: Enoe_2020_T1 procesado usando peso: fac 
⚠️ Omitido: Enoe_2020_T2 – Error: objeto 'Enoe_2020_T2' no encontrado 
✅ Éxito: Enoe_2020_T3 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2020_T4 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2021_T1 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2021_T2 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2021_T3 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2021_T4 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2022_T1 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2022_T2 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2022_T3 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2022_T4 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2023_T1 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2023_T2 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2023_T3 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2023_T4 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2024_T1 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2024_T2 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2024_T3 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2024_T4 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2025_T1 procesado usando peso: fac_tri 
✅ Éxito: Enoe_2025_T2 procesado usando peso: fac_tri 
⚠️ Omitido: Enoe_2025_T3 – Error: objeto 'Enoe_2025_T3' no encontrado 
⚠️ Omitido: Enoe_2025_T4 – Error: objeto 'Enoe_2025_T4' no encontrado </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>serie_ingreso_total</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Año Trimestre     Media IC_Inferior IC_Superior
1  2015         1  5244.229    5179.958    5308.500
2  2015         2  5282.406    5211.691    5353.121
3  2015         3  5404.859    5319.517    5490.202
4  2015         4  5375.187    5295.195    5455.178
5  2016         1  5483.318    5412.380    5554.256
6  2016         2  5527.432    5446.271    5608.593
7  2016         3  5621.110    5534.157    5708.062
8  2016         4  5659.809    5585.124    5734.494
9  2017         1  5766.061    5698.463    5833.659
10 2017         2  5821.228    5748.470    5893.986
11 2017         3  5836.968    5762.706    5911.230
12 2017         4  5862.350    5793.351    5931.349
13 2018         1  6036.973    5961.802    6112.143
14 2018         2  6118.144    6043.262    6193.026
15 2018         3  6149.726    6071.686    6227.766
16 2018         4  6188.929    6114.583    6263.275
17 2019         1  6313.772    6244.581    6382.962
18 2019         2  6352.562    6280.693    6424.430
19 2019         3  6400.166    6330.194    6470.138
20 2019         4  6542.009    6468.949    6615.069
21 2020         1  6824.549    6742.125    6906.973
22 2020         3  6758.452    6647.461    6869.442
23 2020         4  6883.805    6783.932    6983.679
24 2021         1  7129.192    7026.347    7232.038
25 2021         2  7178.877    7069.607    7288.146
26 2021         3  7394.624    7273.187    7516.060
27 2021         4  7390.662    7296.842    7484.481
28 2022         1  7666.625    7572.763    7760.487
29 2022         2  7795.795    7700.024    7891.567
30 2022         3  7841.819    7755.248    7928.390
31 2022         4  8018.257    7927.119    8109.394
32 2023         1  8425.237    8329.190    8521.283
33 2023         2  8592.474    8488.112    8696.835
34 2023         3  8787.320    8684.732    8889.909
35 2023         4  8882.002    8773.506    8990.499
36 2024         1  9323.537    9210.346    9436.727
37 2024         2  9507.358    9374.830    9639.886
38 2024         3  9716.547    9535.681    9897.412
39 2024         4  9812.097    9679.125    9945.068
40 2025         1 10132.974    9974.131   10291.816
41 2025         2 10221.150   10088.949   10353.351</code></pre>
</div>
</div>
<div class="description">
Creamos una columna para la fecha y para la etiqueta de las medias ponderadas.
      <p></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>serie_ENOE15_25<span class="ot">&lt;-</span>serie_ingreso_total<span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fecha=</span><span class="fu">as.Date</span>(<span class="fu">paste</span>(Año, Trimestre <span class="sc">*</span><span class="dv">3-2</span>, <span class="dv">1</span>, <span class="at">sep =</span> <span class="st">"-"</span>), <span class="at">format=</span><span class="st">"%Y-%m-%d"</span>), <span class="co">#Establecemos el formato fecha para las series de tiempo</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Etiqueta_Media =</span> <span class="fu">format</span>(<span class="fu">round</span>(Media, <span class="dv">2</span>), <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">decimal.mark =</span> <span class="st">"."</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>) <span class="co">#Creamos una etiqueta para visualizarla en la serie</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Fecha)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>serie_ENOE15_25</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Año Trimestre     Media IC_Inferior IC_Superior      Fecha Etiqueta_Media
1  2015         1  5244.229    5179.958    5308.500 2015-01-01       5,244.23
2  2015         2  5282.406    5211.691    5353.121 2015-04-01       5,282.41
3  2015         3  5404.859    5319.517    5490.202 2015-07-01       5,404.86
4  2015         4  5375.187    5295.195    5455.178 2015-10-01       5,375.19
5  2016         1  5483.318    5412.380    5554.256 2016-01-01       5,483.32
6  2016         2  5527.432    5446.271    5608.593 2016-04-01       5,527.43
7  2016         3  5621.110    5534.157    5708.062 2016-07-01       5,621.11
8  2016         4  5659.809    5585.124    5734.494 2016-10-01       5,659.81
9  2017         1  5766.061    5698.463    5833.659 2017-01-01       5,766.06
10 2017         2  5821.228    5748.470    5893.986 2017-04-01       5,821.23
11 2017         3  5836.968    5762.706    5911.230 2017-07-01       5,836.97
12 2017         4  5862.350    5793.351    5931.349 2017-10-01       5,862.35
13 2018         1  6036.973    5961.802    6112.143 2018-01-01       6,036.97
14 2018         2  6118.144    6043.262    6193.026 2018-04-01       6,118.14
15 2018         3  6149.726    6071.686    6227.766 2018-07-01       6,149.73
16 2018         4  6188.929    6114.583    6263.275 2018-10-01       6,188.93
17 2019         1  6313.772    6244.581    6382.962 2019-01-01       6,313.77
18 2019         2  6352.562    6280.693    6424.430 2019-04-01       6,352.56
19 2019         3  6400.166    6330.194    6470.138 2019-07-01       6,400.17
20 2019         4  6542.009    6468.949    6615.069 2019-10-01       6,542.01
21 2020         1  6824.549    6742.125    6906.973 2020-01-01       6,824.55
22 2020         3  6758.452    6647.461    6869.442 2020-07-01       6,758.45
23 2020         4  6883.805    6783.932    6983.679 2020-10-01       6,883.81
24 2021         1  7129.192    7026.347    7232.038 2021-01-01       7,129.19
25 2021         2  7178.877    7069.607    7288.146 2021-04-01       7,178.88
26 2021         3  7394.624    7273.187    7516.060 2021-07-01       7,394.62
27 2021         4  7390.662    7296.842    7484.481 2021-10-01       7,390.66
28 2022         1  7666.625    7572.763    7760.487 2022-01-01       7,666.63
29 2022         2  7795.795    7700.024    7891.567 2022-04-01       7,795.80
30 2022         3  7841.819    7755.248    7928.390 2022-07-01       7,841.82
31 2022         4  8018.257    7927.119    8109.394 2022-10-01       8,018.26
32 2023         1  8425.237    8329.190    8521.283 2023-01-01       8,425.24
33 2023         2  8592.474    8488.112    8696.835 2023-04-01       8,592.47
34 2023         3  8787.320    8684.732    8889.909 2023-07-01       8,787.32
35 2023         4  8882.002    8773.506    8990.499 2023-10-01       8,882.00
36 2024         1  9323.537    9210.346    9436.727 2024-01-01       9,323.54
37 2024         2  9507.358    9374.830    9639.886 2024-04-01       9,507.36
38 2024         3  9716.547    9535.681    9897.412 2024-07-01       9,716.55
39 2024         4  9812.097    9679.125    9945.068 2024-10-01       9,812.10
40 2025         1 10132.974    9974.131   10291.816 2025-01-01      10,132.97
41 2025         2 10221.150   10088.949   10353.351 2025-04-01      10,221.15</code></pre>
</div>
</div>
<div class="description">
  Graficamos en una serie de tiempo el ingreso ponderado con los intervalos de confianza.
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>serie_tiempo_enoe<span class="ot">&lt;-</span><span class="fu">ggplot</span>(serie_ENOE15_25, <span class="fu">aes</span>(<span class="at">x=</span>Fecha,  <span class="at">y=</span> Media))<span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin=</span> IC_Inferior, <span class="at">ymax=</span>IC_Superior), <span class="co">#Nos muestra los intervalos de confianza</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="st">"#0072B2"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"#0072B2"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Muestra la etiqueta solo si es el primer trimestre del año (o el único visible)</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(serie_ENOE15_25, Trimestre <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Fecha <span class="sc">==</span> <span class="fu">max</span>(Fecha)), </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Etiqueta_Media),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="co"># Posiciona la etiqueta ligeramente por encima del punto</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># D. Ajustar el Eje X para mostrar los extremos</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="st">"1 year"</span>, <span class="co"># Marcas principales cada año</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%Y"</span>, <span class="co"># Formato de la etiqueta: solo el año (ej. 2015)</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2014-12-01"</span>, <span class="st">"2026-03-01"</span>)) <span class="co"># **LÍMITES AMPLIADOS**</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ingreso Laboral Promedio en México (2015-2025)"</span>,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Media con Intervalo de Confianza del 95%"</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Año(Trimestre)"</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ingreso Promedio Ponderado (MXN)"</span>,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Fuente: Elaboración propia a partir de INEGI ENOE 2015 al 2025"</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="co"># Formato de miles para el eje Y</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>serie_tiempo_enoe</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tasa-de-ingresos_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="description">
  Ahora calculamos la tasa de variación trimestral y la tasa anual.
</div> 
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tasa trimestral</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tasa_inc_ENOE<span class="ot">&lt;-</span>serie_ENOE15_25<span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Fecha)<span class="sc">%&gt;%</span> <span class="co"># Asegurarse de que esté ordenada cronológicamente</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Media_Anterior =</span> <span class="fu">lag</span>(Media, <span class="at">n =</span> <span class="dv">1</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calcular la Tasa de Variación Trimestral (TVT)</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tasa_Trimestral =</span> ((Media <span class="sc">-</span> Media_Anterior) <span class="sc">/</span> Media_Anterior) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Formato para la visualización</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tasa_Trimestral_Etiqueta =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Tasa_Trimestral, <span class="dv">2</span>), <span class="st">"%"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculamos la tasa de variación anual</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>tasa_inc_ENOE<span class="ot">&lt;-</span>tasa_inc_ENOE<span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Obtener la media del mismo trimestre del año anterior (t-4)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Media_Anual_Anterior =</span> <span class="fu">lag</span>(Media, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Calcular la Tasa de Variación Anual (TVA)</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tasa_Anual =</span> ((Media <span class="sc">-</span> Media_Anual_Anterior) <span class="sc">/</span> Media_Anual_Anterior) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Formato para la visualización</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tasa_Anual_Etiqueta =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Tasa_Anual, <span class="dv">2</span>), <span class="st">"%"</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>tasa_inc_ENOE</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Año Trimestre     Media IC_Inferior IC_Superior      Fecha Etiqueta_Media
1  2015         1  5244.229    5179.958    5308.500 2015-01-01       5,244.23
2  2015         2  5282.406    5211.691    5353.121 2015-04-01       5,282.41
3  2015         3  5404.859    5319.517    5490.202 2015-07-01       5,404.86
4  2015         4  5375.187    5295.195    5455.178 2015-10-01       5,375.19
5  2016         1  5483.318    5412.380    5554.256 2016-01-01       5,483.32
6  2016         2  5527.432    5446.271    5608.593 2016-04-01       5,527.43
7  2016         3  5621.110    5534.157    5708.062 2016-07-01       5,621.11
8  2016         4  5659.809    5585.124    5734.494 2016-10-01       5,659.81
9  2017         1  5766.061    5698.463    5833.659 2017-01-01       5,766.06
10 2017         2  5821.228    5748.470    5893.986 2017-04-01       5,821.23
11 2017         3  5836.968    5762.706    5911.230 2017-07-01       5,836.97
12 2017         4  5862.350    5793.351    5931.349 2017-10-01       5,862.35
13 2018         1  6036.973    5961.802    6112.143 2018-01-01       6,036.97
14 2018         2  6118.144    6043.262    6193.026 2018-04-01       6,118.14
15 2018         3  6149.726    6071.686    6227.766 2018-07-01       6,149.73
16 2018         4  6188.929    6114.583    6263.275 2018-10-01       6,188.93
17 2019         1  6313.772    6244.581    6382.962 2019-01-01       6,313.77
18 2019         2  6352.562    6280.693    6424.430 2019-04-01       6,352.56
19 2019         3  6400.166    6330.194    6470.138 2019-07-01       6,400.17
20 2019         4  6542.009    6468.949    6615.069 2019-10-01       6,542.01
21 2020         1  6824.549    6742.125    6906.973 2020-01-01       6,824.55
22 2020         3  6758.452    6647.461    6869.442 2020-07-01       6,758.45
23 2020         4  6883.805    6783.932    6983.679 2020-10-01       6,883.81
24 2021         1  7129.192    7026.347    7232.038 2021-01-01       7,129.19
25 2021         2  7178.877    7069.607    7288.146 2021-04-01       7,178.88
26 2021         3  7394.624    7273.187    7516.060 2021-07-01       7,394.62
27 2021         4  7390.662    7296.842    7484.481 2021-10-01       7,390.66
28 2022         1  7666.625    7572.763    7760.487 2022-01-01       7,666.63
29 2022         2  7795.795    7700.024    7891.567 2022-04-01       7,795.80
30 2022         3  7841.819    7755.248    7928.390 2022-07-01       7,841.82
31 2022         4  8018.257    7927.119    8109.394 2022-10-01       8,018.26
32 2023         1  8425.237    8329.190    8521.283 2023-01-01       8,425.24
33 2023         2  8592.474    8488.112    8696.835 2023-04-01       8,592.47
34 2023         3  8787.320    8684.732    8889.909 2023-07-01       8,787.32
35 2023         4  8882.002    8773.506    8990.499 2023-10-01       8,882.00
36 2024         1  9323.537    9210.346    9436.727 2024-01-01       9,323.54
37 2024         2  9507.358    9374.830    9639.886 2024-04-01       9,507.36
38 2024         3  9716.547    9535.681    9897.412 2024-07-01       9,716.55
39 2024         4  9812.097    9679.125    9945.068 2024-10-01       9,812.10
40 2025         1 10132.974    9974.131   10291.816 2025-01-01      10,132.97
41 2025         2 10221.150   10088.949   10353.351 2025-04-01      10,221.15
   Media_Anterior Tasa_Trimestral Tasa_Trimestral_Etiqueta Media_Anual_Anterior
1              NA              NA                      NA%                   NA
2        5244.229      0.72798470                    0.73%                   NA
3        5282.406      2.31812899                    2.32%                   NA
4        5404.859     -0.54900383                   -0.55%                   NA
5        5375.187      2.01168662                    2.01%             5244.229
6        5483.318      0.80450744                     0.8%             5282.406
7        5527.432      1.69477244                    1.69%             5404.859
8        5621.110      0.68847452                    0.69%             5375.187
9        5659.809      1.87729552                    1.88%             5483.318
10       5766.061      0.95675689                    0.96%             5527.432
11       5821.228      0.27039375                    0.27%             5621.110
12       5836.968      0.43484723                    0.43%             5659.809
13       5862.350      2.97871343                    2.98%             5766.061
14       6036.973      1.34456378                    1.34%             5821.228
15       6118.144      0.51620660                    0.52%             5836.968
16       6149.726      0.63747724                    0.64%             5862.350
17       6188.929      2.01719141                    2.02%             6036.973
18       6313.772      0.61437370                    0.61%             6118.144
19       6352.562      0.74936959                    0.75%             6149.726
20       6400.166      2.21623483                    2.22%             6188.929
21       6542.009      4.31886613                    4.32%             6313.772
22       6824.549     -0.96852510                   -0.97%             6352.562
23       6758.452      1.85476715                    1.85%             6400.166
24       6883.805      3.56470081                    3.56%             6542.009
25       7129.192      0.69691346                     0.7%             6824.549
26       7178.877      3.00530146                    3.01%             6758.452
27       7394.624     -0.05357744                   -0.05%             6883.805
28       7390.662      3.73394787                    3.73%             7129.192
29       7666.625      1.68483516                    1.68%             7178.877
30       7795.795      0.59036636                    0.59%             7394.624
31       7841.819      2.24995811                    2.25%             7390.662
32       8018.257      5.07566913                    5.08%             7666.625
33       8425.237      1.98495184                    1.98%             7795.795
34       8592.474      2.26764272                    2.27%             7841.819
35       8787.320      1.07748697                    1.08%             8018.257
36       8882.002      4.97111306                    4.97%             8425.237
37       9323.537      1.97158388                    1.97%             8592.474
38       9507.358      2.20027956                     2.2%             8787.320
39       9716.547      0.98337705                    0.98%             8882.002
40       9812.097      3.27021688                    3.27%             9323.537
41      10132.974      0.87019183                    0.87%             9507.358
   Tasa_Anual Tasa_Anual_Etiqueta
1          NA                 NA%
2          NA                 NA%
3          NA                 NA%
4          NA                 NA%
5    4.559091               4.56%
6    4.638525               4.64%
7    4.001031                  4%
8    5.295126                5.3%
9    5.156410               5.16%
10   5.315232               5.32%
11   3.840144               3.84%
12   3.578577               3.58%
13   4.698388                4.7%
14   5.100568                5.1%
15   5.358222               5.36%
16   5.570785               5.57%
17   4.585061               4.59%
18   3.831523               3.83%
19   4.072376               4.07%
20   5.705019               5.71%
21   8.089897               8.09%
22   6.389391               6.39%
23   7.556669               7.56%
24   8.975588               8.98%
25   5.191954               5.19%
26   9.412981               9.41%
27   7.363026               7.36%
28   7.538481               7.54%
29   8.593524               8.59%
30   6.047574               6.05%
31   8.491727               8.49%
32   9.894987               9.89%
33  10.219335              10.22%
34  12.057168              12.06%
35  10.772241              10.77%
36  10.662016              10.66%
37  10.647511              10.65%
38  10.574628              10.57%
39  10.471676              10.47%
40   8.681651               8.68%
41   7.507784               7.51%</code></pre>
</div>
</div>
<div class="description">
  Finalmente graficamos la tasa de crecimiento anual.
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tasa_inc_ENOE, <span class="fu">aes</span>(<span class="at">x =</span> Fecha, <span class="at">y =</span> Tasa_Anual)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Sombreado de área bajo/sobre cero (opcional, pero impactante)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_area(aes(y = ifelse(Tasa_Anual &gt; 0, Tasa_Anual, 0)), fill = "#3D9970", alpha = 0.1) + # Crecimiento (verde sutil)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_area(aes(y = ifelse(Tasa_Anual &lt; 0, Tasa_Anual, 0)), fill = "#FF4136", alpha = 0.1) + # Caída (rojo sutil)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Línea Principal: color profesional y grosor adecuado</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Azul oscuro (color profesional)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. Línea de Cero: más prominente</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4. Etiquetas Estratégicas (Máximo, Mínimo y Último Valor)</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creamos un dataframe para etiquetas clave</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtro que combina la lógica profesional con el requisito de etiquetar TODOS los Q4</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trimestre <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> <span class="co"># &lt;--- Agregamos este filtro</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                          Tasa_Anual <span class="sc">==</span> <span class="fu">max</span>(Tasa_Anual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                          Tasa_Anual <span class="sc">==</span> <span class="fu">min</span>(Tasa_Anual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                          Fecha <span class="sc">==</span> <span class="fu">max</span>(Fecha)),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mapeo de estéticas</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Tasa_Anual_Etiqueta, </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="fu">ifelse</span>(Tasa_Anual <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.5</span>)), </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>, </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#0072B2"</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5. Ejes y Escalas</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">8</span>) <span class="co"># Control de número de ticks</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Establece las marcas de división principales cada 1 año</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">"1 year"</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Formatea la etiqueta solo para mostrar el año (ej. 2017)</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%Y"</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6. Títulos y Notas de Fuente</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Tasa de Crecimiento Anual del Ingreso Laboral Ponderado"</span>,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Variación Interanual (T/T-4) - Periodo [Año 2015 - Año 2025]"</span>,</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="co"># Eliminar etiqueta redundante en el eje X</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Tasa de Crecimiento (%)"</span>,</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Fuente: INEGI (ENOE), cálculos propios. Notas: [Tasa Anual comparativa T4]."</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 7. Tema Profesional y Limpio</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>), <span class="co"># Título fuerte y alineado a la izquierda</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">hjust =</span> <span class="dv">0</span>), <span class="co"># Fuente en la esquina inferior izquierda</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">10</span>), <span class="co"># Rotar etiquetas X si el espacio es limitado</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), <span class="co"># Eliminar líneas de cuadrícula verticales</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>() <span class="co"># Eliminar líneas secundarias</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Tasa-de-ingresos_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>



</div></div></div></div></div></div></div></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>